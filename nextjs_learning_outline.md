# Next.js 15+ å…¨æ ˆå¼€å‘å­¦ä¹ å¤§çº²

> âš›ï¸ **"React is a library, Next.js is a framework."**
> åŸºäºæ‚¨çš„è·¯çº¿å›¾ï¼Œè¿™ä»½å¤§çº²å°†å¸¦æ‚¨å½»åº•æŒæ¡ **App Router** æ—¶ä»£çš„ Next.jsï¼Œä»å‰ç«¯ç»„ä»¶ä¸€ç›´å†™åˆ°æ•°æ®åº“ã€‚

---

## ğŸ—ï¸ é˜¶æ®µä¸€ï¼šNext.js å¯èˆª (Initialization)

**ç›®æ ‡**ï¼šå¿˜è®° `create-react-app`ï¼Œæ‹¥æŠ±æœåŠ¡ç«¯æ¸²æŸ“ (SSR)ã€‚

### 1.1 æ ¸å¿ƒæ¦‚å¿µ

- **CSR vs SSR vs SSG**: ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ Next.jsï¼Ÿ(SEO, é¦–å±æ€§èƒ½).
- **Project Structure**: ç†è§£ `app/` ç›®å½•ç»“æ„ï¼Œ`public/`ï¼Œä»¥åŠé…ç½®æ–‡ä»¶ `next.config.js`ã€‚

### 1.2 è·¯ç”±åŸºç¡€ (File-system Routing)

- **Pages**: `page.tsx` â€”â€” æ¯ä¸€ä¸ªæ–‡ä»¶å¤¹å°±æ˜¯ä¸€ä¸ªè·¯ç”±ã€‚
- **Layouts**: `layout.tsx` â€”â€” åµŒå¥—å¸ƒå±€ï¼ŒçŠ¶æ€ä¿æŒï¼ˆä¸é‡æ–°æ¸²æŸ“ï¼‰ã€‚
- **Navigation**: `<Link>` ç»„ä»¶ä¸ `useRouter` é’©å­ã€‚

---

## âš¡ é˜¶æ®µäºŒï¼šApp Router ä¸ RSC (The Core)

**ç›®æ ‡**ï¼šå½»åº•ç†è§£ React çš„â€œåˆ†æ°´å²­â€ â€”â€” æœåŠ¡ç«¯ç»„ä»¶ã€‚

### 2.1 React Server Components (RSC)

- **é»˜è®¤å³æœåŠ¡ç«¯**: æ‰€æœ‰çš„ç»„ä»¶é»˜è®¤éƒ½æ˜¯ Server Componentã€‚
- **"use client"**: ä»€ä¹ˆæ—¶å€™éœ€è¦å®¢æˆ·ç«¯ç»„ä»¶ï¼Ÿ(äº¤äº’, Hooks, æµè§ˆå™¨ API)ã€‚
- **Server Component ä¼˜åŠ¿**: ç›´æ¥æŸ¥æ•°æ®åº“ï¼Œé›¶ Bundle Sizeï¼Œä¿æŠ¤å¯†é’¥ã€‚

### 2.2 ç‰¹æ®Šæ–‡ä»¶çº¦å®š

- `loading.tsx`: è‡ªåŠ¨å¤„ç† Suspense åŠ è½½çŠ¶æ€ã€‚
- `error.tsx`: ä¼˜é›…çš„é”™è¯¯è¾¹ç•Œ (Error Boundary)ã€‚
- `not-found.tsx`: è‡ªå®šä¹‰ 404 é¡µé¢ã€‚

---

## ğŸ“¡ é˜¶æ®µä¸‰ï¼šæ•°æ®è·å–ä¸ç¼“å­˜ (Data Fetching & Caching)

**ç›®æ ‡**ï¼šæœ€éš¾å•ƒçš„éª¨å¤´ï¼Œä¹Ÿæ˜¯ Next.js æœ€å¼ºå¤§çš„åœ°æ–¹ã€‚

### 3.1 Fetch API å¢å¼º

- **Native Fetch**: Next.js å¯¹åŸç”Ÿçš„ `fetch` åšäº†é­”æ”¹ã€‚
- **Caching ç­–ç•¥**:
  - `force-cache`: æ°¸ä¹…ç¼“å­˜ (SSG)ã€‚
  - `no-store`: åŠ¨æ€æ¸²æŸ“ (SSR)ã€‚
  - `next: { revalidate: 3600 }`: å¢é‡é™æ€å†ç”Ÿ (ISR) â€”â€” _Sensei æç¤ºï¼šè¿™æ˜¯æœ€å®ç”¨çš„ç­–ç•¥_ã€‚

### 3.2 Server Actions (Vercel çš„æ€æ‰‹é”)

- **åŸç†**: åœ¨ç»„ä»¶é‡Œç›´æ¥å†™ `async function` å¤„ç†è¡¨å•æäº¤ï¼Œåƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·è°ƒç”¨åç«¯ã€‚
- **å®æˆ˜**: `<form action={createPost}>`ï¼Œå½»åº•å‘Šåˆ« `useEffect` å‘è¯·æ±‚ã€‚

---

## ğŸ”Œ é˜¶æ®µå››ï¼šAPI è·¯ç”±ä¸åç«¯å¼€å‘ (Full Stack)

**ç›®æ ‡**ï¼šNext.js ä¸ä»…ä»…æ˜¯å‰ç«¯ï¼Œå®ƒå°±æ˜¯ä½ çš„åç«¯ã€‚

### 4.1 Route Handlers

- **API ç¼–å†™**: åœ¨ `app/api/route.ts` é‡Œå†™ `GET`, `POST` å¤„ç† CRUDã€‚
- **Request/Response**: å¤„ç† Headers, Cookies å’Œ JSON Bodyã€‚

### 4.2 æ•°æ®åº“é›†æˆ

- **ORM**: Prisma æˆ– Drizzle ORM å®æˆ˜ã€‚
- **è¿æ¥æ± **: æ³¨æ„ Serverless ç¯å¢ƒä¸‹çš„è¿æ¥æ•°é™åˆ¶ (Neon / Supabase)ã€‚

---

## ğŸ¨ é˜¶æ®µäº”ï¼šä¼˜åŒ–ä¸å·¥ç¨‹åŒ– (Optimization)

**ç›®æ ‡**ï¼šè®© Google æœç´¢å¼•æ“çˆ±ä¸Šä½ çš„ç½‘ç«™ã€‚

### 5.1 SEO ä¼˜åŒ–

- **Metadata API**: åœ¨ `layout.tsx` æˆ– `page.tsx` é‡ŒåŠ¨æ€ç”Ÿæˆ `title`, `description`ã€‚
- **Sitemap & Robots**: è‡ªåŠ¨ç”Ÿæˆçˆ¬è™«æ–‡ä»¶ã€‚

### 5.2 æ€§èƒ½ä¼˜åŒ–

- **Image Component**: `<Image>` è‡ªåŠ¨å‹ç¼©ã€æ‡’åŠ è½½ã€é˜²æŠ–åŠ¨ã€‚
- **Font Optimization**: `next/font` é›¶å¸ƒå±€åç§»ã€‚
- **Lazy Loading**: `next/dynamic` åŠ¨æ€å¯¼å…¥é‡ç»„ä»¶ã€‚

---

## ğŸš€ é˜¶æ®µå…­ï¼šé¡¹ç›®å®æˆ˜ä¸éƒ¨ç½² (Deployment)

**ç›®æ ‡**ï¼šä¸Šçº¿ï¼

### 6.1 å®æˆ˜é¡¹ç›®ï¼šå…¨æ ˆåšå®¢ / SaaS é¢æ¿

- **Auth**: é›†æˆ Clerk æˆ– NextAuth.js (Auth.js) å®ç° GitHub/Google ç™»å½•ã€‚
- **CMS**: ä½¿ç”¨ Sanity æˆ– Notion ä½œä¸ºå†…å®¹æºã€‚
- **æ”¯ä»˜**: é›†æˆ Stripe å¤„ç†è®¢é˜…ã€‚

### 6.2 éƒ¨ç½² (Vercel)

- **CI/CD**: æ¨é€ GitHub è‡ªåŠ¨éƒ¨ç½²ã€‚
- **ç¯å¢ƒå˜é‡**: ç”Ÿäº§ç¯å¢ƒé…ç½®ã€‚
- **Edge Functions**: è®©è®¡ç®—è·‘åœ¨å…¨çƒçš„è¾¹ç¼˜èŠ‚ç‚¹ä¸Šã€‚

---

> ğŸ’¡ **Sensei çš„å»ºè®®**
>
> 1.  **åˆ«è¢«ç¼“å­˜æç–¯**: Next.js é»˜è®¤ç¼“å­˜æå…¶æ¿€è¿›ã€‚å¦‚æœä½ å‘ç°ä¿®æ”¹äº†æ•°æ®åº“ä½†é¡µé¢æ²¡å˜ï¼Œæ£€æŸ¥ä¸€ä¸‹ Data Cacheã€‚
> 2.  **Server Components æ˜¯æœªæ¥**: å°½é‡æŠŠé€»è¾‘ç•™åœ¨æœåŠ¡ç«¯ï¼ŒåªæŠŠéœ€è¦â€œç‚¹ä¸€ä¸‹â€çš„æŒ‰é’®åšæˆ Client Componentã€‚
> 3.  **æ‹¥æŠ± TypeScript**: åœ¨ Next.js é‡Œï¼ŒTS èƒ½ç»™ä½ æä¾›æè‡´çš„ç«¯åˆ°ç«¯ç±»å‹å®‰å…¨ (End-to-End Type Safety)ã€‚
